<html lang="da">
<head>
    <meta charset="UTF-8">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body>

    <nav class="navbar">
        <ul>
            <li class="left">
                <a href="{{ url_for('forside') }}">
                    <i class="fas fa-arrow-left"></i>
                </a>
            </li>
            <li class="right">
                <a href="{{ url_for('login') }}">
                    <i class="fas fa-user"></i>
                </a>
            </li>
        </ul>
    </nav>

<div class="App">
    <header class="App-header">
        <h2>Dine favoritter</h2>

        {% if favoritter %}
            <div class="results">
                {% for fav in favoritter %}
                    <div class="result-card" id="fav-{{ fav.id }}">
                        {% if fav.image %}
                            <img src="{{ fav.image }}" alt="{{ fav.painting }}">
                        {% endif %}

                        <i class="fa-solid fa-heart heart-btn filled" data-id="{{ fav.id }}"></i>

                        <div class="result-content">
                            <h3>{{ fav.painting }}</h3>
                            <p><strong>Artist:</strong> {{ fav.artist }}</p>
                            <p><strong>Year:</strong> {{ fav.year }}</p>
                            <p><strong>Genre:</strong> {{ fav.genre }}</p>
                            {% if fav.notes %}
                                <div class="note-box">
                                    {% for note in fav.notes %}
                                        <div class="note">{{ note.content }}</div>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p class="no-results">Ingen favoritter endnu ❤️</p>
        {% endif %}
    </header>
</div>

<script>
document.querySelectorAll('.heart-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        const artworkId = btn.dataset.id;
        btn.classList.toggle('filled');
        btn.classList.toggle('fa-solid');
        btn.classList.toggle('fa-regular');

        // Fjerne kortet fra DOM
        const card = document.getElementById(`fav-${artworkId}`);
        if (!btn.classList.contains('filled')) {
            card.remove();
            // Her kan du lave en fetch til backend for at fjerne favoritten fra DB
            fetch(`/fjern_favorit/${artworkId}`, { method: 'POST' });
        }
    });
});
</script>
</body>
</html>
